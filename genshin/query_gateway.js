const protobuf = require("protobufjs");
const dataUtil = require("../util/dataUtil");
async function query_cur_region_protobuffer() {

    var hack_query = 'GhFiZXRhX3JlbGVhc2UwMV9jbiINMTA2LjE1LjIzMC40OSiFtgFAAUgBUkJodHRwczovL2F1dG9wYXRjaGNuLmJoc3IuY29tL2FzYi9CZXRhTGl2ZS9vdXRwdXRfNTExNDA4X2Q1MGQ2YWIwMzNaSmh0dHBzOi8vYXV0b3BhdGNoY24uYmhzci5jb20vZGVzaWduX2RhdGEvQmV0YUxpdmUvb3V0cHV0XzUxMTkzMl83MjI1ZDI2YjZlYkJodHRwczovL2F1dG9wYXRjaGNuLmJoc3IuY29tL2x1YS9CZXRhTGl2ZS9vdXRwdXRfNTExMzk1XzNkNjc4ZTlmZDZ4AooB0BVSV015WWhBQUFBQ01WNmtBUE4zTmpuWkhCV2RFdEx2WEFBZ0FBQ0tUa2xTMEhydFRDSG55VHFRZHpnQmNmblcwN0QraW9kVU1SR0h6VWtIZGp6U091UlJDL2JFNmlXSmJLaTZBaFhxcTFtTG44TURkdWlqOXE3clorcit6YWFUSmN6ZStGUHhua1E3VkxtQVRlcGx6eUJWZTFZRjZ2N3luOGplYjBOZ1hMRHhLQ2RSSHcwd1MvNXMwdk5CMzNXU0pIclRtZjNuRXpySVBIU0hGTlp5bkZOMzVOWFNPSHV0VTFEUDlxYWNHb0tGdmpZMTBTeWIyUndhN0tzUmpIdVhHUERBYVVMWDhaUk05VStWTUVlaWRKcUhUY3ZJTUpLemVydVcwUGdKRjYzcC9RYmtRMmpiWGU4eThwY0hHMW5NdFJ0NkZadThhZWxWMWRZYTZZV2M5SmdJRWdiVEZLYjZJREpsU1BoL2Y5RUdvNENidlBudnRJWm93QjQ2Rkh6ZkcwY0lpL1RlWXBlVUtzbkY0UzdFQnJMZGJtdEZnWEErODF4ZjVjcTJockxwQnBiZkN5SFhtVHAvWlhsWW9hVTB5TGJIWW9USE9nTzdBUlRyQk95T0ExZEtCZFliQ2dNNnFnMk9uRUQ4a2JCZGFYVzYxWllBMWRESzNkdUIxMzBJQTM1MDFoTW0xNWNmTFZQMXJVNUx0eGhRUkszY2lTaFExZlVNVGdoM3lGeVhaMXVFQTBlTDRBdVA5TUh6aDlnNW5iVVBLbXBjQk9iOTRqVWc3QmFRbG9rVzFJV2M0RlQxVGdDa1U5RlBSYWVMdS83Z0VzYmZVK2lSUVlGTDMvK0pMbjdVZTdCa2o5ZVVmRXFFQzZrUUYvTG9rQTg2UVZBRnJXUDZYS1ExQm5OUzhRU1lRTDlpamsrTWJXRUI5MUhHWTBTcWhMai9vY3gwR3cwcmx5b3FZV2RnK1Y3d1AwUVNFVUxLVXZaTzJ5aEZYTnVqZjlRUjB4Rno1cHVtZndGTjlqcWtkaVVYSzN6SDNKcG5BN0pka1F3elJ0bXJMNGtSMEVwQ3FVT1J6aWlDYnhHSTFCRjUwU1RHeWMxVlUzcFN2L0FEd0VzbTN2bXg1NWxJMk9hQlAwZlZpRllJSE4yU0VtanFYYVVhZjFjMmd0cWlkbFA4bGw3YjM3TytrdFBsMDdzYTkzK0t0bXNYcDNiM2xVVXVhd0pKcjJUVkhRQ1RMa1J2NHFtZ1ZETzdXaHVzL1pRRlUrQjVlNG5ZbXJYeWR2L0hwK2dMVWhGRzJMbktXSCtobUIwYUNWTGY3NlhZMW5uL05CeDVIT1lkd2pLei9nb08raUk4ZFBJeFFQcllNZEVKWWxvbVBTN1N4R0ZNZDBCdCtBNWxOaFFIVlpUaXlHNnA1Q3ArRmRCY0dlSzdIN1pZMG5abkgwQ0ZvZ0xoditDUmtUVDF6YWhEYWU1eVdxQzFtdWlIN1B2ZTFPZUwxcUtRYjJrTWgxdmdrWUp3bmR4cTFaajdQR1ZVZm41UTVhcjVmWGllYmh5R0x6d3d0UFJUTTlLd3g3QWFUR2JsTmVWdDRkNjQzL01KUjlRVU8xREV2blFDOFVxYmJmYUpYQVBzQnhRSm9JVlBkbEtYc1RPS0lpcUdmZEpDMGJPbUxmWFlOdTdsekxnWm5HVUs2OHBIZ0tYOTFYVkpWV3RtbXE0Rm9GRTZrT1lzcEpmTmhta3c2dlZTWmZSQnJrSEw5RHZaSHl0d0RYc0g2bGZyOVg3VHBibkczaUtkY2lDMXZhWE5nU0RFRFU5dUtET0RJSkxNekgyUndJVXp6bHhJTjJWOU8xQ1BONlc1Ylg4M1ArZXdCblZsNGMwQk40Nkt3dVNEQWxqT1FZUzNNVVM2Q1NXRzR2MHFxUjlKcXNJK3Vpc1lBYTg0SXM5U1J3ZU4yNnVOTStySFFRK2E4ZVV2dHpWWFpRYVl2Q3BwUHF5UXJvZVd2N0JJRVk2a0tkenQ3QVBNdm1JV3ZjTnBXSFNrMmNrZFBPRUVwcDRHRXZTa1YycnkybS9sSHhkYlRFWUdvZlhUTGcxMUlQZnFWemowMDJCdWw0SVJyZzNkODVpOTRXeDRpeXZhcEVyK0w4L0xzQWk3RStDaTk0M2JObGNrRktMRDJ5Y0hkK2Fvb3Y5MUlQNGxvaFVHT0RxWlBuSWgySHM4K1VBK2gxWE1OVUJRQlpxak9BR2YzYnV3K1FyME9oQ05ZNDlLUE1Tckt5b3ZLcUJYalJlNHZhU3k3SHFiOTl6anNZNXNRWGhodHJWTDQ2VkUzY0puNWlYR0plU3BDVHdPUVBITWVxNlI4NUF5SkplY3hTdEFJdUE0bWU3c3pXQjMrTVVac2JIRm1lSkRYNy9OMGNJVURRUnBEaXNnNDl5WFd4SzFkL01mY2RJVGlZL0crWFl1Z1NYMDhVUmc2NDV4YUJsWjY1UGNDTUNucUhNalNSdUozbnBjdkxOKzFzVVB2QUM1cjlTbUc3NS9aNGp3Y256SzYyNUo5bWViWURuRDR1UVMyVWRXbmNES0lFc3hlMkFJL1NJekxGeWNidzJ3d040NWk0WDlrUFllODNyNmt3R3RiNkRkTXVDTGlvd0pIVUorbEltM1h4U3BVTVFMaTE1YnI5QlVnY1FVc2JabmEzdjFvOUVwVzdFbHlLcDZuK0xRM0o0eHArRmQ4TVBEbzhxWXNlbVZQenM3RExjblFIYnJmSEJxZGhWazcvOFZKUFBRanhNN016Zk5DNnpOMDkrWjY1dVZ3VU9aOWlhK241WHBuUTRlV3Y5UHNzVUtWcEh1K0N0QnVlTDRKTHV6WTMvTXJBNSs2YUtoT3B6OTd0Z3NOM0M3ZjhzM21GeXJmUnNkS1V2aktOeXJYS2FvQjRvcXVTdmZhKzJQWnJTR2REcFFnNVVZOU5ybHl1SkVoTGdOTU5UTDM3OXR2UEkyelUzU1BlS0IwVjdSb2lVbFJMQmJ5OVFpbXk1djJDUFVzajZZYzRTb1lRcGNQVVBiQTVJYzR4a2xERWZhejJkbzZTSzNiY1EzK0tUTlRFNVZFQ2h5ZFBYN0xYQzAyMGwxVFlCdDkrMlRyRzkxQnZwYmw2N2FDMVhnYk1RNkR0SkQ1SWt3cGpWMUpuMFIxUmhtVzE1a2xEZ3pOd1lnS2R2K21GRG9YbDkyMmtlMmZmVHBuUlJyOGs5TTlSTlZRYmtMTUtPUkV1QUJxQTRnSCtTS1VrdTNLWEROK3FpR3JQbXpoa0JhaWtSVFNMNFJTeWVmRUw3eVpaQURNRjJjUmlmVnJhZGFxWUYvUE9MSjRqOS93NVhaQXJwSU5idG9oS3ZJREpmK0xnOVg4YVBOSlBUMnl5TTlJcGZZRFFseDFuWkhUaUxKaHhhTHYwOXJHbmJGY24xcTk1QkVJMGVjZ1RGUGxDVWNQbURSMnJadUtOU2ZKQTBvc3gyV0FqczlvYlBUSENXQzhMWkFabmlnNlhOQzNQcmtNQ3hRQ1pIVVRGUjhybnVRNllwOVBoUzNNZkVBcmUzb2Z2OFNsV0pKcTRVQ0ViWjVlM2FqMUp1WFBIWUtvTWFZT21KSnRseEl2amc2YzhsMjJINXl4WkhRbXplVnFWMmNQVUtNN2hQRUxaTUVzcFY2VUZYMkh4VG41UitpcnZXaFBaQzVXNFRpbJIBB3xma3xhZGSiAaABaHR0cHM6Ly93ZWJzdGF0aWMubWlob3lvLmNvbS9oa3JwZy9ldmVudC9pbS1zZXJ2aWNlL2luZGV4Lmh0bWw/aW1fb3V0PWZhbHNlJnNpZ25fdHlwZT0yJmF1dGhfYXBwaWQ9aW1fY2NzJmF1dGhrZXlfdmVyPTEmZ2FtZV9iaXo9aGtycGdfY24md2luX2RpcmVjdGlvbj1wb3J0cmFpdLIBTmh0dHBzOi8vdXNlci5taWhveW8uY29tLyMvYWJvdXQvcHJpdmFjeUluR2FtZT9hcHBfaWQ9OCZsYW5nPXpoLWNuJmJpej1oa3JwZ19jbsIBOeW9k+WJjeeJiOacrOS4uua1i+ivleeJiOacrO+8jOS4jeS7o+ihqOa4uOaIj+acgOe7iOWTgei0qA=='
    const root = await protobuf.load("proto/QueryCurrRegionHttpRsp.proto");
    const testMessage = root.lookup("QueryCurrRegionHttpRsp");
    
    const queryList = testMessage.decode(Buffer.from(hack_query, 'base64'));

    queryList["regionInfo"].gateserverIp = "127.0.0.1"
    //queryList15["regionInfo"].gateserverPort = 80
    //queryList15["regionInfo"].resource_url = "https://autopatchhk.yuanshen.com/client_game_res/2.4_live"
    //queryList15["regionInfo"].data_url = "https://autopatchhk.yuanshen.com/client_design_data/2.4_live"
   // queryList15["regionInfo"]["resVersionConfig"].versionSuffix = queryList14["regionInfo"]["resVersionConfig"].versionSuffix

    queryList15.clientSecretKey = queryList14.clientSecretKey;
    queryList15.regionCustomConfigEncrypted = queryList14.regionCustomConfigEncrypted;

    const encoded = testMessage.encode(queryList15).finish();
    console.log(queryList15);
    return encoded;
}

module.exports = {
    async execute(req, res) {   
        var ret = await query_cur_region_protobuffer();
        res.end(Buffer.from(ret).toString('base64'));
    }
}
